% Connectivity matrix analysis - Structural connectome


%% Test for 3 WT mice - Option -zero_diagonal and -symmetric
close all
clear
clc

posReduced = 25;
firstPosNull = 1;

pathConnectomeArray = [...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230517_025205_MRtrix-output_studyWt-MAP6Mice/Mouse-1/connectome_tracks_3_cutoff-0.3000_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal.csv";...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230517_025205_MRtrix-output_studyWt-MAP6Mice/Mouse-2/connectome_tracks_3_cutoff-0.2800_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal.csv";...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230517_025205_MRtrix-output_studyWt-MAP6Mice/Mouse-3/connectome_tracks_3_cutoff-0.2800_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal.csv";...
    ];

arrayTitles = [...
    "M672 - cutoff: 0.30";...
    "M872 - cutoff: 0.28";...
    "M8876 - cutoff: 0.28";...
];

labels = ["FP_R","SMa_R","SSa_R","GVAa_R","Va_R","FC_R","TPEa_R","Oa_R","HP_R","PHr_R","OS_R","SD_R","SV_R","Sr_R","Aa_R","PL_R","TH_R","HT_R","CO_R","MB_R","SN_R","PO_R","ME_R","CVr_R","CHr_R","FP_L","SMa_L","SSa_L","GVAa_L","Va_L","FC_L","TPEa_L","Oa_L","HP_L","PHr_L","OS_L","SD_L","SV_L","Sr_L","Aa_L","PL_L","TH_L","HT_L","CO_L","MB_L","SN_L","PO_L","ME_L","CVr_L","CHr_L"];

minScaleBar = 0;
maxScaleBar = 15000;

%% Test for 3 WT mice - Option -scale_invnodevol -zero_diagonal and -symmetric
close all
clear
clc

posReduced = 25;
firstPosNull = 1;

pathConnectomeArray = [...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230517_025205_MRtrix-output_studyWt-MAP6Mice/Mouse-1/connectome_tracks_3_cutoff-0.3000_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal-scaleInvnodevol.csv";...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230517_025205_MRtrix-output_studyWt-MAP6Mice/Mouse-2/connectome_tracks_3_cutoff-0.2800_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal-scaleInvnodevol.csv";...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230517_025205_MRtrix-output_studyWt-MAP6Mice/Mouse-3/connectome_tracks_3_cutoff-0.2800_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal-scaleInvnodevol.csv";...
    ];

arrayTitles = [...
    "M672 - cutoff: 0.30 - scale inv. vol";...
    "M872 - cutoff: 0.28 - scale inv. vol";...
    "M8876 - cutoff: 0.28 - scale inv. vol";...
];

labels = ["FP_R","SMa_R","SSa_R","GVAa_R","Va_R","FC_R","TPEa_R","Oa_R","HP_R","PHr_R","OS_R","SD_R","SV_R","Sr_R","Aa_R","PL_R","TH_R","HT_R","CO_R","MB_R","SN_R","PO_R","ME_R","CVr_R","CHr_R","FP_L","SMa_L","SSa_L","GVAa_L","Va_L","FC_L","TPEa_L","Oa_L","HP_L","PHr_L","OS_L","SD_L","SV_L","Sr_L","Aa_L","PL_L","TH_L","HT_L","CO_L","MB_L","SN_L","PO_L","ME_L","CVr_L","CHr_L"];

minScaleBar = 0;
maxScaleBar = 0.8;



%% 6 WT and 6 MAP6 +/- mice - Option -zero_diagonal and -symmetric
close all
clear
clc

posReduced = 25;
firstPosNull = 1;

pathConnectomeArray = [...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230603_022151_MRtrix-output_studyWt-MAP6Mice_allMice_6wt-6hetMAP6/Mouse-1/connectome_tracks_3_cutoff-0.3000_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal.csv";...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230603_022151_MRtrix-output_studyWt-MAP6Mice_allMice_6wt-6hetMAP6/Mouse-2/connectome_tracks_3_cutoff-0.2800_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal.csv";...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230603_022151_MRtrix-output_studyWt-MAP6Mice_allMice_6wt-6hetMAP6/Mouse-3/connectome_tracks_3_cutoff-0.3000_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal.csv";...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230603_022151_MRtrix-output_studyWt-MAP6Mice_allMice_6wt-6hetMAP6/Mouse-4/connectome_tracks_3_cutoff-0.2900_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal.csv";...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230603_022151_MRtrix-output_studyWt-MAP6Mice_allMice_6wt-6hetMAP6/Mouse-5/connectome_tracks_3_cutoff-0.3000_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal.csv";...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230603_022151_MRtrix-output_studyWt-MAP6Mice_allMice_6wt-6hetMAP6/Mouse-6/connectome_tracks_3_cutoff-0.2800_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal.csv";...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230603_022151_MRtrix-output_studyWt-MAP6Mice_allMice_6wt-6hetMAP6/Mouse-7/connectome_tracks_3_cutoff-0.2900_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal.csv";...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230603_022151_MRtrix-output_studyWt-MAP6Mice_allMice_6wt-6hetMAP6/Mouse-8/connectome_tracks_3_cutoff-0.2800_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal.csv";...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230603_022151_MRtrix-output_studyWt-MAP6Mice_allMice_6wt-6hetMAP6/Mouse-9/connectome_tracks_3_cutoff-0.2800_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal.csv";...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230603_022151_MRtrix-output_studyWt-MAP6Mice_allMice_6wt-6hetMAP6/Mouse-10/connectome_tracks_3_cutoff-0.2900_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal.csv";...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230603_022151_MRtrix-output_studyWt-MAP6Mice_allMice_6wt-6hetMAP6/Mouse-11/connectome_tracks_3_cutoff-0.2900_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal.csv";...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230603_022151_MRtrix-output_studyWt-MAP6Mice_allMice_6wt-6hetMAP6/Mouse-12/connectome_tracks_3_cutoff-0.2900_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal.csv";...
    ];

arrayTitles = [...
    "M672 - cutoff: 0.30";...
    "M872 - cutoff: 0.28";...
    "M874 - cutoff: 0.30";...
    "M875 - cutoff: 0.29";...
    "M886 - cutoff: 0.30";...
    "M8876 - cutoff: 0.28";...
    "M757 - cutoff: 0.29";...
    "M857 - cutoff: 0.28";...
    "M866 - cutoff: 0.28";...
    "M867bis - cutoff: 0.29";...
    "M877 - cutoff: 0.29";...
    "M881bis - cutoff: 0.29";...
];

labels = ["FP_R","SMa_R","SSa_R","GVAa_R","Va_R","FC_R","TPEa_R","Oa_R","HP_R","PHr_R","OS_R","SD_R","SV_R","Sr_R","Aa_R","PL_R","TH_R","HT_R","CO_R","MB_R","SN_R","PO_R","ME_R","CVr_R","CHr_R","FP_L","SMa_L","SSa_L","GVAa_L","Va_L","FC_L","TPEa_L","Oa_L","HP_L","PHr_L","OS_L","SD_L","SV_L","Sr_L","Aa_L","PL_L","TH_L","HT_L","CO_L","MB_L","SN_L","PO_L","ME_L","CVr_L","CHr_L"];

minScaleBar = 0;
maxScaleBar = 15000;

%% 6 WT and 6 MAP6 +/- mice - Option -scale_invnodevol -zero_diagonal and -symmetric
close all
clear
clc

posReduced = 25;
firstPosNull = 1;

pathConnectomeArray = [...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230603_022151_MRtrix-output_studyWt-MAP6Mice_allMice_6wt-6hetMAP6/Mouse-1/connectome_tracks_3_cutoff-0.3000_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal-scaleInvnodevol.csv";...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230603_022151_MRtrix-output_studyWt-MAP6Mice_allMice_6wt-6hetMAP6/Mouse-2/connectome_tracks_3_cutoff-0.2800_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal-scaleInvnodevol.csv";...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230603_022151_MRtrix-output_studyWt-MAP6Mice_allMice_6wt-6hetMAP6/Mouse-3/connectome_tracks_3_cutoff-0.3000_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal-scaleInvnodevol.csv";...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230603_022151_MRtrix-output_studyWt-MAP6Mice_allMice_6wt-6hetMAP6/Mouse-4/connectome_tracks_3_cutoff-0.2900_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal-scaleInvnodevol.csv";...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230603_022151_MRtrix-output_studyWt-MAP6Mice_allMice_6wt-6hetMAP6/Mouse-5/connectome_tracks_3_cutoff-0.3000_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal-scaleInvnodevol.csv";..."/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230603_022151_MRtrix-output_studyWt-MAP6Mice_allMice_6wt-6hetMAP6/Mouse-3/connectome_tracks_3_cutoff-0.3000_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal-scaleInvnodevol.csv";...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230603_022151_MRtrix-output_studyWt-MAP6Mice_allMice_6wt-6hetMAP6/Mouse-6/connectome_tracks_3_cutoff-0.2800_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal-scaleInvnodevol.csv";...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230603_022151_MRtrix-output_studyWt-MAP6Mice_allMice_6wt-6hetMAP6/Mouse-7/connectome_tracks_3_cutoff-0.2900_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal-scaleInvnodevol.csv";...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230603_022151_MRtrix-output_studyWt-MAP6Mice_allMice_6wt-6hetMAP6/Mouse-8/connectome_tracks_3_cutoff-0.2800_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal-scaleInvnodevol.csv";...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230603_022151_MRtrix-output_studyWt-MAP6Mice_allMice_6wt-6hetMAP6/Mouse-9/connectome_tracks_3_cutoff-0.2800_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal-scaleInvnodevol.csv";...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230603_022151_MRtrix-output_studyWt-MAP6Mice_allMice_6wt-6hetMAP6/Mouse-10/connectome_tracks_3_cutoff-0.2900_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal-scaleInvnodevol.csv";...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230603_022151_MRtrix-output_studyWt-MAP6Mice_allMice_6wt-6hetMAP6/Mouse-11/connectome_tracks_3_cutoff-0.2900_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal-scaleInvnodevol.csv";...
    "/data_network/summer_projects/alvesrod/Share/2023_mouse-dMRI/postProcessing/tractographyConnectome/20230603_022151_MRtrix-output_studyWt-MAP6Mice_allMice_6wt-6hetMAP6/Mouse-12/connectome_tracks_3_cutoff-0.2900_minl-0.1_maxl-50_step-0.01_angle-8.1921_symmetric-zeroDiagonal-scaleInvnodevol.csv";...
    ];

arrayTitles = [...
    "M672 - cutoff: 0.30";...
    "M872 - cutoff: 0.28";...
    "M874 - cutoff: 0.30";...
    "M875 - cutoff: 0.29";...
    "M886 - cutoff: 0.30";...
    "M8876 - cutoff: 0.28";...
    "M757 - cutoff: 0.29";...
    "M857 - cutoff: 0.28";...
    "M866 - cutoff: 0.28";...
    "M867bis - cutoff: 0.29";...
    "M877 - cutoff: 0.29";...
    "M881bis - cutoff: 0.29";...
];

labels = ["FP_R","SMa_R","SSa_R","GVAa_R","Va_R","FC_R","TPEa_R","Oa_R","HP_R","PHr_R","OS_R","SD_R","SV_R","Sr_R","Aa_R","PL_R","TH_R","HT_R","CO_R","MB_R","SN_R","PO_R","ME_R","CVr_R","CHr_R","FP_L","SMa_L","SSa_L","GVAa_L","Va_L","FC_L","TPEa_L","Oa_L","HP_L","PHr_L","OS_L","SD_L","SV_L","Sr_L","Aa_L","PL_L","TH_L","HT_L","CO_L","MB_L","SN_L","PO_L","ME_L","CVr_L","CHr_L"];



minScaleBar = 0;
maxScaleBar = 0.8;
%%

ticksArray = [1:1:posReduced*2];
ticksLabels = strrep(labels,'_', '\_');
ticksFontSize = 5;

corrMatrixWTReduced = zeros(posReduced*2,posReduced*2,size(pathConnectomeArray,1));

for index=1:size(pathConnectomeArray,1)

corrMatrixWT(:,:,index) = csvread(pathConnectomeArray(index));
corrMatrixWTReduced(1:posReduced,1:posReduced,index) = corrMatrixWT((1+firstPosNull):(posReduced+firstPosNull),(1+firstPosNull):(posReduced+firstPosNull),index);
corrMatrixWTReduced(posReduced+1:end,posReduced+1:end,index) = corrMatrixWT(((size(corrMatrixWT,1) - firstPosNull)/2 + 1 + firstPosNull):((size(corrMatrixWT,1) - firstPosNull)/2 + 1 + firstPosNull + posReduced - 1),((size(corrMatrixWT,1) - firstPosNull)/2 + 1 + firstPosNull):((size(corrMatrixWT,1) - firstPosNull)/2 + 1 + firstPosNull + posReduced - 1),index);

end
%figure('units','normalized','outerposition',[0 0 1 1]);
%imshow(squeeze(corrMatrixWT(:,:,index)),[])
%colormap 'jet'


figure('units','normalized','outerposition',[0 0 1 1]);
for index=1:size(pathConnectomeArray,1)
subplot(4,3,index)
imshow(squeeze(corrMatrixWTReduced(:,:,index)),[])
colormap 'jet'
c = colorbar;
c.FontSize = 10;
caxis([minScaleBar maxScaleBar])
axis on
ax = gca;
ax.FontSize = ticksFontSize; 
xticks(ticksArray)
xticklabels(ticksLabels)
xtickangle(90)
yticks(ticksArray)
yticklabels(ticksLabels)
title(arrayTitles(index),'FontSize',12)
end
sgtitle("Structural connectome - 50 labels")



figure('units','normalized','outerposition',[0 0 1 1]);
subplot(1,3,1)
imshow(squeeze(corrMatrixWT(:,:,1)),[])
colormap 'jet'
colorbar
title("M672 - cutoff: 0.30")

subplot(1,3,2)
imshow(squeeze(corrMatrixWT(:,:,2)),[])
colormap 'jet'
colorbar
title("M872 - cutoff: 0.28")
sgtitle("Structural connectome")

subplot(1,3,3)
imshow(squeeze(corrMatrixWT(:,:,3)),[])
colormap 'jet'
colorbar
title("M8876 - cutoff: 0.28")
sgtitle("Structural connectome - all labels")
